{{!--
  file: ./templates/layouts/grid-layout.hbs
  Pattern 11: Grid Layout (2/3/4 columns)
  
  Description:
  Multi-column grid layout for displaying multiple features, services, or 
  offerings side-by-side. Supports 2, 3, or 4 equal-width columns with 
  individual panels containing content.
  
  Configuration Source: *.content.json â†’ blocks[id].layout = "grid-layout"
  
  Content Structure:
  {
    "layout": "grid-layout",
    "columns": 4,
    "elements": [
      {"type": "title", "content": "Our Solutions", "level": 2, "position": "header"}
    ],
    "panels": [
      {
        "title": "MLM",
        "elements": [
          {"type": "paragraph", "content": "..."},
          ...
        ]
      }
    ]
  }
  
  Features:
  - Supports 2, 3, or 4 columns (default: 2)
  - Optional header section (title/paragraph) spans full width
  - Each panel contains independent elements array
  - Panels display as equal-width cards
  - Responsive: adjusts columns on tablet, stacks on mobile
  - Consistent styling across all panels
  
  CSS Classes:
  - .static-section
  - .feature-list-section (grid container)
  - .feature-panel-container
  - .columns-{n}
  - .feature-panel
  
  Usage:
  Called by renderer when block.layout === "grid-layout"
  
  Common Use Cases:
  - Service offerings (4 market types)
  - Product tiers (3 pricing levels)
  - Feature matrix (multiple offerings)
  - Team members grid
  - Partner/client logos
--}}

{{#with block}}
<section class="static-section feature-list-section" 
         data-block-id="{{id}}"
         data-pattern="grid-layout"
         {{#if className}}data-custom-class="{{className}}"{{/if}}>
  
  {{!-- Header Section (Optional - spans full width) --}}
  {{#if elements}}
    {{#each elements}}
      {{#if (or (not position) (eq position "header"))}}
        
        {{!-- Title Element --}}
        {{#if (eq type "title")}}
          <h2 class="section-title">{{{escapeHtml content}}}</h2>
        {{/if}}
        
        {{!-- Paragraph Element --}}
        {{#if (eq type "paragraph")}}
          <p class="section-description">{{{markdown content}}}</p>
        {{/if}}
        
      {{/if}}
    {{/each}}
  {{/if}}
  
  {{!-- Grid Panel Container --}}
  <div class="feature-panel-container {{gridColumnClass (default columns 2)}}">
    
    {{!-- Render Each Panel --}}
    {{#each panels}}
      <div class="feature-panel">
        
        {{!-- Panel Header (Metadata Title and Icon) --}}
        <div class="feature-panel-header">
          
          {{!-- FIX: Render the panel's direct metadata title --}}
          {{#if title}}
            <h3 class="panel-title">{{escapeHtml title}}</h3>
          {{/if}}
          
          {{!-- Render elements intended for header (Icons) --}}
          {{#each elements}}
            
            {{!-- Icon/Media Element (optional) --}}
            {{#if (eq type "media")}}
              {{#if (eq mediaType "icon")}}
                <img src="{{mediaPath src}}" 
                     class="feature-icon" 
                     alt="{{escapeHtml alt}}"
                     width="32" 
                     height="32">
              {{else}}
                {{{renderMedia this}}}
              {{/if}}
            {{/if}}
            
          {{/each}}
        </div>
        
        {{!-- Panel Content (Paragraphs, Lists, CTAs) --}}
        <div class="feature-panel-content">
          {{#each elements}}
            
            {{!-- Paragraph Element --}}
            {{#if (eq type "paragraph")}}
              {{{renderParagraph this}}}
            {{/if}}
            
            {{!-- List Element --}}
            {{#if (eq type "list")}}
              {{{renderList this}}}
            {{/if}}
            
            {{!-- Call-to-Action Element --}}
            {{#if (eq type "callToAction")}}
              {{{renderCTA this}}}
            {{/if}}
            
            {{!-- Spacer Element --}}
            {{#if (eq type "spacer")}}
              {{{renderSpacer this}}}
            {{/if}}
            
          {{/each}}
        </div>
        
      </div>
    {{/each}}
    
  </div>
  
</section>
{{/with}}